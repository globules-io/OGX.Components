/* OGX.JS FlexCells@1.2.2 */
require("FlexCells","Uxi","Template","Touch","Placeholder");OGX.FlexCells=function(o){construct(this,"FlexCells");"use strict";var d=this;var e={axis:"x",min:10,template:null,children:["50%","30%","20%"]};var h=OGX.Data.merge(o,e,false);var u=this.el;var _={x:0,y:0,m:0};var v=null;this.construct=function(){};this.cellSize=function(e,l,s){if(typeof e==="undefined"){var a=[];this.el.children(".ogx_flex_cell").each((e,l)=>{a.push($(l).css("flex-basis"))});return a}typeof l==="string"?l=Number(l.replace("%","")):null;var i,t,r,c;i=this.el.children('.ogx_flex_cell[data-cell="'+e+'"]');if(e<this.el.children(".ogx_flex_cell").length-1){t=this.el.children('.ogx_flex_cell[data-cell="'+(e+1)+'"]')}else{t=this.el.children('.ogx_flex_cell[data-cell="'+(e-1)+'"]')}r=l-Number(i.css("flex-basis").split("%").shift());c=Number(t.css("flex-basis").split("%").shift())-r;i.css("flex-basis",l+"%");t.css("flex-basis",c+"%");setTimeout(()=>d.resizeNodes(),5)};this.renderAt=function(e,l){this.clearAt(e);l=OGX.OML.rename(l,'.ogx_flex_cells[data-ogx-id="'+this.id+'"] > .ogx_flex_cell[data-cell="'+e+'"]');h["node:OML"].push(l);OGX.OML.render(this,l)};this.clearAt=function(e){var s,a;this.el.children('.ogx_flex_cell[data-cell="'+e+'"]').find(".ogx_uxi").each(function(e,l){s=$(l).data("ogx-id");a=d.find(null,s);if(a){a.kill()}})};function l(){var e="";for(var l=0;l<h.children.length;l++){e+='<span class="ogx_flex_cell" data-cell="'+l+'" style="flex-basis:'+h.children[l]+'"></span>';if(l<h.children.length-1){e+='<span class="ogx_flex_cell_resize"></span>'}}u.html(e)}function s(e){v=$(e.target);_.x=0;_.y=0;_.m=0}function a(e){var l;var s=u.width();if(o.axis==="x"){l=(e.distX-_.m)*100/s;_.m=e.distX}else{l=(e.distY-_.m)*100/u.height();_.m=e.distY}var a=Number(v.prev().css("flex-basis").split("%")[0]);var i=Number(v.next().css("flex-basis").split("%")[0]);var t=v.prev();var r=v.next();var c,n;if(Array.isArray(h.min)){var x=t.data("cell");var f=r.data("cell");c=h.min[x];n=h.min[f]}else{c=n=h.min}if(!isNaN(c)){c=c*100/s}else{c=Number(c.replace("%",""))}if(!isNaN(n)){n=n*100/s}else{n=Number(n.replace("%",""))}if(a+l>c&&i-l>n){v.prev().css("flex-basis",a+l+"%");v.next().css("flex-basis",i-l+"%");d.el.trigger(OGX.FlexCells.RESIZE);setTimeout(()=>d.resizeNodes(),5)}}function i(){var e={id:"move",min:0,target:".ogx_flex_cell_resize",cb_down:s,cb_move:a,capture:true};if(h.axis==="x"){e.x=true}else{e.y=true}d.touch.add("Move",e)}function t(){var e=u.children();var s=e.length;e.each(function(e,l){$(l).addClass("ogx_flex_cell").attr("data-cell",e).css("flex-basis",h.children[e]);if(e<s-1){$(l).after('<span class="ogx_flex_cell_resize"></span>')}})}function r(){var e=u.parent().children().not(".ogx_flex_cells");var l=e.clone();var s=e.length;var a;u.append(e);l.each(function(e,l){a=$(l);a.remove()});return s}function c(){var e=[];for(var l=0;l<h["node:OML"].length;l++){for(var s in h["node:OML"][l]){e.push('.ogx_flex_cells[data-ogx-id="'+d.id+'"] > .ogx_flex_cell[data-cell="'+l+'"]')}}d.placeholders(h,e)}function n(){u.addClass("ogx_flex_cells");if(h.axis==="x"){u.addClass("ogx_flex_cells_row")}else{u.addClass("ogx_flex_cells_col")}var e=false;if(!h.template){e=r()}t();c();if(!h.template&&!e){l()}i()}n()};OGX.FlexCells.RESIZE="FlexCellsResize";