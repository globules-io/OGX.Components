/* OGX.JS FlexCells@1.2.1 */
require("FlexCells","Uxi","Template","Touch","Placeholder");OGX.FlexCells=function(o){construct(this,"FlexCells");"use strict";var d=this;var e={axis:"x",min:10,template:null,children:["50%","30%","20%"]};var h=OGX.Data.merge(o,e,false);var _=this.el;var u={x:0,y:0,m:0};var v=null;this.construct=function(){};this.cellSize=function(e,l,s){if(typeof e==="undefined"){var i=[];this.el.children(".ogx_flex_cell").each((e,l)=>{i.push($(l).css("flex-basis"))});return i}typeof l==="string"?l=Number(l.replace("%","")):null;var a,t,r,c;a=this.el.children('.ogx_flex_cell[data-cell="'+e+'"]');if(e<this.el.children(".ogx_flex_cell").length-1){t=this.el.children('.ogx_flex_cell[data-cell="'+(e+1)+'"]')}else{t=this.el.children('.ogx_flex_cell[data-cell="'+(e-1)+'"]')}r=l-Number(a.css("flex-basis").split("%").shift());c=Number(t.css("flex-basis").split("%").shift())-r;a.css("flex-basis",l+"%");t.css("flex-basis",c+"%");setTimeout(()=>d.resizeNodes(),5)};this.renderAt=function(e,l){this.clearAt(e);l=OGX.OML.rename(l,'.ogx_flex_cells[data-ogx-id="'+this.id+'"] > .ogx_flex_cell[data-cell="'+e+'"]');h["node:OML"].push(l);OGX.OML.render(this,l)};this.clearAt=function(e){var s,i;this.el.children('.ogx_flex_cell[data-cell="'+e+'"]').find(".ogx_uxi").each(function(e,l){s=$(l).data("ogx-id");i=d.find(null,s);if(i){i.kill()}})};function l(){var e="";for(var l=0;l<h.children.length;l++){e+='<span class="ogx_flex_cell" data-cell="'+l+'" style="flex-basis:'+h.children[l]+'"></span>';if(l<h.children.length-1){e+='<span class="ogx_flex_cell_resize"></span>'}}_.html(e)}function s(e){v=$(e.target);u.x=0;u.y=0;u.m=0}function i(e){var l;var s=_.width();if(o.axis==="x"){l=(e.distX-u.m)*100/s;u.m=e.distX}else{l=(e.distY-u.m)*100/_.height();u.m=e.distY}var i=Number(v.prev().css("flex-basis").split("%")[0]);var a=Number(v.next().css("flex-basis").split("%")[0]);var t=v.prev();var r=v.next();var c,n;if(Array.isArray(h.min)){var x=t.data("cell");var f=r.data("cell");c=h.min[x];n=h.min[f]}else{c=n=h.min}if(!isNaN(c)){c=c*100/s;n=n*100/s}if(i+l>c&&a-l>n){v.prev().css("flex-basis",i+l+"%");v.next().css("flex-basis",a-l+"%");d.el.trigger(OGX.FlexCells.RESIZE);setTimeout(()=>d.resizeNodes(),5)}}function a(){var e={id:"move",min:0,target:".ogx_flex_cell_resize",cb_down:s,cb_move:i,capture:true};if(h.axis==="x"){e.x=true}else{e.y=true}d.touch.add("Move",e)}function t(){var e=_.children();var s=e.length;e.each(function(e,l){$(l).addClass("ogx_flex_cell").attr("data-cell",e).css("flex-basis",h.children[e]);if(e<s-1){$(l).after('<span class="ogx_flex_cell_resize"></span>')}})}function r(){var e=_.parent().children().not(".ogx_flex_cells");var l=e.clone();var s=e.length;var i;_.append(e);l.each(function(e,l){i=$(l);i.remove()});return s}function c(){var e=[];for(var l=0;l<h["node:OML"].length;l++){for(var s in h["node:OML"][l]){e.push('.ogx_flex_cells[data-ogx-id="'+d.id+'"] > .ogx_flex_cell[data-cell="'+l+'"]')}}d.placeholders(h,e)}function n(){_.addClass("ogx_flex_cells");if(h.axis==="x"){_.addClass("ogx_flex_cells_row")}else{_.addClass("ogx_flex_cells_col")}var e=false;if(!h.template){e=r()}t();c();if(!h.template&&!e){l()}a()}n()};OGX.FlexCells.RESIZE="FlexCellsResize";