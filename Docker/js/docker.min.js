/* OGX.JS Docker@1.0.0 */
require("Docker","Uxi","Touch");OGX.Docker=function(e){construct(this,"Docker");"use strict";var n=this;var o,a;var i={template:'{{$count > 1 ? @ct = "" : @ct = "hidden"; $visible ? @vz = "" : @vz = "hidden";}}<span class="ogx_docker_item_icon" style="background-image:url({{$icon}})"></span><span class="ogx_docker_item_line {{@vz}}"></span><span class="ogx_docker_item_count {{@ct}}">{{$count}}</span>',groups:{user:{icon:{default:"/img/user.png",bind:{lookup:"Views.UserProfile",method:"getIcon",property:"icon"}}}}};var s=OGX.Data.merge(e,i,false,true);var u=null;this.el=null;this.construct=function(){v()};this.enable=function(){};this.disable=function(){};this.ux=function(e){if(e){a.el.on(OGX.DynamicList.SELECT,l);o.on("mouseover",".ogx_docker_item",function(e){var o=$(this);var i=o.data("ogx-id");var n=a.val().get({id:{eq:i}},null,1);f(o,n)});o.on("mouseout",".ogx_docker_item",m);$(document).on(OGX.Popup.SHOW,t);$(document).on(OGX.Popup.HIDE,d);$(document).on(OGX.Popup.CLOSE,r);$(document).on(OGX.Popup.GROUP,c);$(document).on(OGX.Popup.UNGROUP,p)}else{a.el.off(OGX.DynamicList.SELECT,l);o.off("mouseover",".ogx_docker_item");o.off("mouseout",".ogx_docker_item",m);$(document).off(OGX.Popup.SHOW,t);$(document).off(OGX.Popup.HIDE,d);$(document).off(OGX.Popup.CLOSE,r);$(document).off(OGX.Popup.GROUP,c);$(document).off(OGX.Popup.UNGROUP,p)}};this.addItem=function(e,o){typeof o==="undefined"?o=null:null;var i=0;if(!o){var n=s.groups[e.group].icon;o=n.default;if(n.hasOwnProperty("bind")&&n.bind){var t=e.gather(n.bind.lookup);if(t.length===1){if(n.bind.hasOwnProperty("method")){o=t[0][n.bind.method]()}else{if(n.bind.hasOwnProperty("property")){o=t[0][n.bind.property]}}}}}if(e.group){if(e.nodes.length&&e.nodes[0]._NAME_==="Container"){i=e.nodes[0].children("Carousel")[0].nodes.length}}var d={id:e.id,icon:o,count:i,visible:true};a.insert(d)};this.removeItem=function(e){a.findDelete("id",e,1)};this.findItem=function(e,o){var i=app.cfind(e,o);if(i){var n=app.findPopup(i);if(n){return n}}return false};this.findShow=function(e,o){var i=this.find(e,o);if(i){i.reveal();return true}return false};function t(e,o){a.findUpdate("id",o.id,{visible:true},false,1)}function d(e,o){a.findUpdate("id",o.id,{visible:false},false,1)}function r(e,o){n.removeItem(o)}function c(e,o){a.findDelete("id",o.popups[0],1);a.findDelete("id",o.popups[1],1);n.addItem(o.popup)}function p(e,o){a.findUpdate("id",o.from_popup,{count:1},false,1);var i=app.cfind("Popup",o.to_popup);n.addItem(i)}function l(e,o){var i=app.cfind("Popup",o.id);a.findUpdate("id",o.id,{visible:true},false,1);i.show(false)}function f(e,o){if(u){u.remove();u=null}var i=app.cfind("Popup",o.id);var n=e.offset();var t='<div class="ogx_docker_sub" data-id="'+o.id+'" style="left:'+n.left+"px; top:"+(n.top+e.height())+"px; transform: translateX( calc(-50% + "+e.width()/2+'px) )">';var d,a;if(o.count>1){d=i.nodes[0].nodes[0].el.children(".ogx_tabs_container").find(".ogx_tabs_tab_label");d.each(function(e,o){a=$(o).html();t+='<span class="ogx_docker_sub_label">'+a+"</span>"})}else{a=i.title();t+='<span class="ogx_docker_sub_label">'+a+"</span>"}t+="</div>";$("body").append(t);u=$("body").children('.ogx_docker_sub[data-id="'+o.id+'"]')}function m(e){if(u){u.remove();u=null}}function _(){n.el=$(e.el);o=n.el;o.html('<div class="docker_list"></div>').addClass("ogx_docker")}function v(){a=n.create("DynamicList",{el:'.ogx_uxi[data-ogx-id="'+n.id+'"] .docker_list',id:"docker_list",key:"id",mode:"hit",display:{html:s.template,css:"ogx_docker_item"}})}function h(){_()}h()};